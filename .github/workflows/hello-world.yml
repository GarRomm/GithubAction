name: Hello World Workflow

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
    - name: R√©cup√©ration du code
      uses: actions/checkout@v4
      
    - name: Configuration de Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
      
    - name: Installation des d√©pendances
      run: npm install
      
    - name: Compilation du projet
      run: |
        echo "üî® Compilation en cours..."
        echo "‚úÖ Compilation r√©ussie!"
        
    - name: Sauvegarde des fichiers compil√©s
      run: echo "build-output" > build.txt
      
    - name: T√©l√©chargement de l'art√©fact de build
      uses: actions/upload-artifact@v4
      with:
        name: build-artifacts
        path: build.txt
  
  test:
    runs-on: ubuntu-latest
    needs: build
    
    steps:
    - name: R√©cup√©ration du code
      uses: actions/checkout@v4
      
    - name: Configuration de Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
      
    - name: T√©l√©chargement de l'art√©fact de build
      uses: actions/download-artifact@v4
      with:
        name: build-artifacts
    
    - name: V√©rification de l'art√©fact
      run: |
        echo "üì¶ Contenu de l'art√©fact:"
        cat build.txt
    
    - name: Ex√©cution des tests
      run: |
        echo "üß™ Ex√©cution des tests..."
        echo "‚úÖ Tous les tests sont pass√©s!"
  
  greeting:
    runs-on: ubuntu-latest
    needs: test
    
    env:
      MESSAGE: "D√©ploiement r√©ussi"
    
    steps:
    - name: R√©cup√©ration du code
      uses: actions/checkout@v4
      
    - name: Configuration de Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
      
    - name: Installation des d√©pendances
      run: npm install
      
    - name: Ex√©cution du linting
      run: npm run lint
      
    - name: Dire bonjour
      run: echo "Hello, World!"
      
    - name: Affichage de la variable d'environnement
      run: echo "$MESSAGE"
      
    - name: Utilisation du secret API Key
      env:
        API_KEY: ${{ secrets.API_KEY }}
      run: |
        echo "La cl√© API est configur√©e"
        echo "Valeur de la cl√© API: $API_KEY"
    
    - name: G√©n√©ration du fichier de rapport
      run: echo "Rapport d'analyse" > report.txt
    
    - name: T√©l√©chargement de l'art√©fact
      uses: actions/upload-artifact@v4
      with:
        name: rapport-analyse
        path: report.txt